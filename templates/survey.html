{% extends "core.html" %}
{% include "utils.html" %}
{% from "components/summary/_macro.njk" import onsSummary %}
{% from "components/button/_macro.njk" import onsButton %}
{% macro checkBox() %}
    check
{%- endmacro %}
{% block main %}
    <h1 class="ons-u-mt-m">Choose a section to complete</h1>
    {{ onsSummary({
            "variant": "hub",
            "classes": "ons-u-mt-m",
            "summaries": [
                {
                    "groups": [
                        {
                            "rows": [
                                {
                                    "rowTitle": "Project Details",
                                    "rowItems": [
                                        {
                                            "valueList": [
                                                {
                                                    "text": "<div id='user_details'></div>"
                                                }
                                            ],
                                          "id": "user-details",

                                            "iconType": "chevron",
                                            "actions": [
                                                {
                                                    "text": "Change",
                                                    "ariaLabel": "View answers for People who live here",
                                                    "url": url_for('project_pre_survey'),
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "rowTitle": "Code and Architecture",
                                    "rowItems": [
                                        {
                                            "valueList": [
                                            {
                                                "text": "<div id='project_details'></div>"
                                            }
                                        ],
                                        "id": "project-details",
                                            "iconType": "chevron", 
                                            "actions": [
                                                {   
                                                    "text": "Change",
                                                    "ariaLabel": "View answers for Household accommodation",
                                                    "url": url_for('architecture_pre_survey')
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "rowTitle": "Technology Details",
                                    "rowItems": [
                                        {
                                            "valueList": [
                                            {
                                                "text": "<div id='developed_details'></div>"
                                            }
                                        ],
                                        "id": "developed-details",
                                            "iconType": "chevron",
                                            "actions": [
                                                {
                                                    "text": "Change",
                                                    "ariaLabel": "View answers for Mary Smith",
                                                    "url": url_for('tech_pre_survey')
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "rowTitle": "Supporting Tools",
                                    "rowItems": [
                                        {
                                            "valueList": [
                                            {
                                                "text": "<div id='supporting_tools'></div>"
                                            }
                                        ],
                                        "id": "supporting-tools",
                                            "iconType": "chevron",
                                            "actions": [
                                                {
                                                    "text": "Change",
                                                    "ariaLabel": "View answers for Mary Smith",
                                                    "url": url_for('supporting_tools_pre_survey')
                                                }
                                            ]
                                        }
                                    ]
                                },
                            ]
                        }
                    ]
                }
            ]
        }) }}
        <div style="display: flex; justify-content: space-between; gap: 10px;">
    {{ onsButton({
            "id": "primary-submit-btn",
            "text": '<div id="primary-submit-btn-text">Continue to Submission</div>',
            "classes": 'ons-u-mb-m ons-u-mt-l',
            "url": url_for('validate_details')
        }) }}
    {{ onsButton({
            "id": "secondary-submit-btn",
            "text": '<div id="secondary-submit-btn-text">Continue to Submission</div>',
            "classes": 'ons-u-mb-m ons-u-mt-l',
            "variants": "secondary",
            "url": url_for('validate_details')
        }) }}
        </div>
        <script src="{{ url_for('static', filename='formScripts.js') }}"></script>
    <script>
        function load_data() {
            // Project Details
            var contactTechData = localStorage.getItem('contact_tech-data');
            var contactManagerData = localStorage.getItem('contact_manager-data');
            var projectData = localStorage.getItem('project-data');
            var developedData = localStorage.getItem('developed-data');
            var stageData = localStorage.getItem('stage-data');
            // Architecture Details
            var sourceControlData = localStorage.getItem('source_control-data');
            var hostingData = localStorage.getItem('hosting-data');
            var databaseData = localStorage.getItem('database-data');
            // Technology Details
            var frameworksData = localStorage.getItem('frameworks-data');
            var infrastructureData = localStorage.getItem('infrastructure-data');
            var integrationsData = localStorage.getItem('integrations-data');
            var languagesData = localStorage.getItem('languages-data');
            // Supporting Tools Details
            var codeEditorsData = localStorage.getItem('code_editors-data');
            var uiDesignData = localStorage.getItem('user_interface-data');
            var diagramsData = localStorage.getItem('diagrams-data');
            var projectTrackingData = localStorage.getItem('project_tracking-data');
            var documentationData = localStorage.getItem('documentation-data');
            var communicationData = localStorage.getItem('communication-data');
            var collaborationData = localStorage.getItem('collaboration-data');
            var incidentManagementData = localStorage.getItem('incident_management-data');
            
            changeBtnURL(contactTechData, contactManagerData, projectData, 
            sourceControlData, databaseData, languagesData, 
            frameworksData, integrationsData, infrastructureData, 
            codeEditorsData, uiDesignData, diagramsData, 
            projectTrackingData, documentationData, communicationData, 
            collaborationData, incidentManagementData);
            updateSectionStatus('user_details', [contactTechData, contactManagerData, projectData, developedData, stageData]);
            updateSectionStatus('project_details', [sourceControlData, hostingData, databaseData]);
            updateSectionStatus('developed_details', [frameworksData, infrastructureData, integrationsData, languagesData]);
            updateSectionStatus('supporting_tools', [codeEditorsData, uiDesignData, diagramsData, projectTrackingData, documentationData, communicationData, collaborationData, incidentManagementData]);
        }
        load_data();
        localStorage.setItem("source_control-validate", false);
        localStorage.setItem("hosting-validate", false);
    </script>
{% endblock %}
{% extends "layout/_template.njk" %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/password/_macro.njk" import onsPassword %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/table/_macro.njk" import onsTable %}
{% from "components/tabs/_macro.njk" import onsTabs %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/tabs/_macro.njk" import onsTabs %}
{% set pageConfig = {
      "header": {
          "title": "Keh Tech Audit Tool"
      },
      
      "footer": {
          "OGLLink": {
              "pre": "All content is available under the", "link": "Open Government Licence v3.0",
              "url": "https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",
              "post": ", except where otherwise stated"
          }
      }
  } %}
{% block main %}


  {% with messages = get_flashed_messages() %}
  {% if messages %}
    <ul class="flashes">
      {% for message in messages %}
        <li>{{ message }}</li>
      {% endfor %}
    </ul>
  {% endif %}
  {% endwith %}
  {% set createTab = {
      "id": "add-project",
      "text": "Add Project",
      "url": url_for("pre_survey")
    
  } %}
  {% set methodsTable = {
    "id": "ready-table",
    "variants": ["responsive"],
    "tableClasses": "ons-u-mt-m",
    "ths": [
      {
        "value": "Your Projects",

      }

    ]
  } %}
  {% set methodsTableRows = [] %}
  {% for project in projects %}
    {% do methodsTableRows.append({
      "tds": [
        {
            "value":'<a href="' + url_for("view_project", project_name=project.details[0].name) + '">' + project.details[0].name + '</a>'
        },
      ]
    }) %}
  {% endfor %}

  {% set searchBar = {
        "id": "search-bar",
        "label": {
            "text": "Search for a project"
        }
    } 
  %}

  {% set title = "<h2>Add Project</h2>" %}

  {% do methodsTable.update({"trs": methodsTableRows}) %}
  {{ onsTabs({
        "title": 'Contents',
        "titleClasses": 'ons-u-fs-m',
        "tabs": [
                    {
                "id": "my-projects",
                "title": 'View My Projects',
                "showTitle": true,
                "content": onsInput(searchBar) + onsTable(methodsTable)

            },
            {
                "id": "add-projects",
                "title": 'Create a Project',
                "showTitle": true,
                "content": onsButton(createTab)

            },
          ]

    }) }}

{% endblock %}
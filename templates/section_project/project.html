{% extends "core.html" %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/question/_macro.njk" import onsQuestion %}
{% from "components/accordion/_macro.njk" import onsAccordion %}
{% from "components/textarea/_macro.njk" import onsTextarea %}
{% block main %}
    <h1>Project Details</h1>
    {{ onsAccordion({
        "id": "accordion-example",
        "itemsList": [
            {
                "title": "More info",
                "content": "<p>Enter the following information about the project:</p>
                <h3>Project name</h3>
                <p>The full unabbreviated name of your project, e.g. Statistical Production Platform.</p>
                <h3>Shortened Project Name</h3>
                <p>The commonly used abbreviation or acronym associated with the project, e.g. SPP.</p>
                <h3>Documentation link</h3>
                <p>A high level overview of the project and solution, or the homepage for such documentation.</p>
                <h3>Project Description</h3>
                <p>A concise overview of your project that offers a clear understanding for both technical and non-technical stakeholders.</p>
                <p>A good description will cover:</p>
                    <li>The <b>purpose</b> of the project (what problem it solves or value it provides).</li>
                    <li>What the project <b>implements</b> (its key features or functionality).</li>
                    <li>The main <b>consumers</b> of the project (end users, other teams, or systems).</li><br>"
            }
        ]
    }) }}
    <form action="{{ url_for('survey') }}" method="GET">
        {{ onsInput({
        "id": "project-name",
        "label": {
            "text": "What is the name of the project?"
        },
        
    }) }}
        {{ onsInput({
        "id": "project-short-name",
        "label": {
            "text": "What is the short name of the project?"
        }
    }) }}
        {{ onsInput({
        "id": "documentation-link",
        "label": {
            "text": "Is there a link to the documentation for this project?"
        }
    }) }}
        {{ onsTextarea({
        "id": "project-description",
        "name": "feedback-limited",
        "width": "30",
        "label": {
            "text": "Project Description",
            "description": "What is the project about? What are the projects aims and objectives?"
        },
        "charCheckLimit": {
            "limit": 200,
            "charCountSingular": "You have {x} character remaining",
            "charCountPlural": "You have {x} characters remaining"
        }
    }) }}
        {% call onsQuestion({
        "classes": "ons-u-mt-no",
        "legendIsQuestionTitle": true
    }) %}
        {% endcall %}
        <script src="{{ url_for('static', filename='formScripts.js') }}"></script>
        {{ onsButton({
        "id": "save-values-button",
        "text": "Save and continue",
        "url": url_for('developed'),
        "attributes": {
            "onclick": "storeData();"
        }
    }) }}
        <script>
            function storeData() { // Store Details about project in local storage
                var project_name = document.getElementById('project-name').value;
                var project_short_name = document.getElementById('project-short-name').value;
                var project_description = document.getElementById('project-description').value;
                var doc_link = document.getElementById('documentation-link').value;
                var complete = (project_name !== '' && project_short_name !== '');
                var data = {
                    "project_name": project_name,
                    "project_short_name": project_short_name,
                    "project_description": project_description,
                    "doc_link": doc_link,
                    "complete": complete
                };
                var name = 'project-data'
                if (JSON.parse(localStorage.getItem('edit'))) {
                    name = 'project-data-edit'
                }
                localStorage.setItem(name, JSON.stringify(data));
            }
            function loadData() {
                var name = 'project-data';
                if (JSON.parse(localStorage.getItem('edit'))){
                    name = name + '-edit';
                }
                    var data = JSON.parse(localStorage.getItem(name));
                    if (data) {
                        document.getElementById('project-name').value = data.project_name;
                        document.getElementById('project-short-name').value = data.project_short_name;
                        document.getElementById('documentation-link').value = data.doc_link;
                        document.getElementById('project-description').value = data.project_description;
                    }
            
            }
            redirectToPrevious();
            loadData();
        </script>
    </form>
{% endblock %}
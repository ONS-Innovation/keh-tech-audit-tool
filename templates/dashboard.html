{% extends "layout/_template.njk" %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/password/_macro.njk" import onsPassword %}
{% from "components/button/_macro.njk" import onsButton %}
{% from "components/table/_macro.njk" import onsTable %}
{% from "components/tabs/_macro.njk" import onsTabs %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/input/_macro.njk" import onsInput %}
{% from "components/button/_macro.njk" import onsButton %}


{%
  set pageConfig = {
      "header": {
          "title": "Keh Tech Audit Tool"
      },
      
      "footer": {
          "OGLLink": {
              "pre": "All content is available under the", "link": "Open Government Licence v3.0",
              "url": "https://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/",
              "post": ", except where otherwise stated"
          }
      }
  }
%}

{% block main %}
{% with messages = get_flashed_messages() %}
{% if messages %}
  <ul class=flashes>
  {% for message in messages %}
    <li>{{ message }}</li>
  {% endfor %}
  </ul>
{% endif %}
{% endwith %}

{% set methodsTable = {
    "id": "ready-table",
    "variants": ["responsive"],
    "tableClasses": "ons-u-mt-m",
    "ths": [
      {
        "value": "Project Name"
      },
      {
        "value": onsButton({
            "text": "Add Project",
            "url": url_for("pre_survey"),
        })
      }
    ]
  } %}
  {% set methodsTableRows = [] %}
  {% for project in projects %}
    {% do methodsTableRows.append({
      "tds": [
        {
            "value":'<a href="' + url_for("view_project", project_name=project.project_name) + '">' + project.project_name + '</a>'
        },
      ]
    }) %}
  {% endfor %}
  {% do methodsTable.update({"trs": methodsTableRows}) %}

  {{
    onsTable(methodsTable)
  }}

{% endblock %}
